<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ê·€ì—¼ë½€ì§ ê°•ì•„ì§€ í‚¤ìš°ê¸°</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Gowun+Dodum&display=swap');
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: 'Gowun Dodum', sans-serif;
      background-color: #fff8f0;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    h1 {
      margin-top: 30px;
      font-size: 2.8rem;
      color: #ff914d;
    }
    .screen {
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }
    .active {
      display: flex !important;
    }
    .button {
      padding: 12px 24px;
      margin: 10px;
      font-size: 1.1rem;
      background: #ffcdcd;
      border: none;
      border-radius: 15px;
      cursor: pointer;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      transition: background 0.2s;
    }
    .button:hover {
      background: #ffa4a4;
    }
    input {
      padding: 10px;
      font-size: 1rem;
      border-radius: 10px;
      border: 1px solid #ccc;
      margin-top: 10px;
    }
    #game-wrapper {
      width: 95%;
      max-width: 820px;
      aspect-ratio: 4 / 3;
      position: relative;
      background: #fff;
      border-radius: 20px;
      overflow: hidden;
      box-shadow: 0 10px 25px rgba(0,0,0,0.1);
      margin-top: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    .status-bar {
      position: absolute;
      top: 10px;
      left: 10px;
      background: rgba(255, 255, 255, 0.95);
      padding: 10px 15px;
      border-radius: 15px;
      font-size: 0.95rem;
      line-height: 1.4;
      border: 1px solid #ffdad5;
    }
    .event-timer {
      position: absolute;
      top: 10px;
      right: 10px;
      background: rgba(255, 243, 234, 0.95);
      padding: 10px 15px;
      border-radius: 15px;
      font-size: 0.95rem;
      color: #cc5c00;
      border: 1px dashed #ffa65e;
    }
    .celebrate {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 2.2rem;
      background: #fff3cd;
      color: #d9480f;
      padding: 15px 25px;
      border: 2px solid #ffd6a5;
      border-radius: 20px;
      box-shadow: 0 5px 10px rgba(0,0,0,0.1);
      z-index: 999;
      display: none;
    }
    .puppy-image {
      width: 260px;
      height: auto;
      margin: 10px;
      transition: transform 0.3s ease;
    }
    .shake {
      animation: shake 0.6s ease;
    }
    .grow {
      animation: grow 0.6s ease;
    }
    @keyframes shake {
      0% { transform: translateX(0); }
      25% { transform: translateX(-10px); }
      50% { transform: translateX(10px); }
      75% { transform: translateX(-10px); }
      100% { transform: translateX(0); }
    }
    @keyframes grow {
      0% { transform: scale(1); }
      50% { transform: scale(1.3); }
      100% { transform: scale(1); }
    }
    .interaction-toggle {
      margin-top: 20px;
    }
    .interaction-panel {
      display: none;
      flex-direction: column;
      align-items: center;
      margin-top: 10px;
    }
    .interaction-panel .button {
      background: #d2f4dc;
      margin: 5px;
    }
  </style>
</head>
<body>
<h1>ğŸ¶ ê·€ì—¼ë½€ì§ ê°•ì•„ì§€ í‚¤ìš°ê¸°</h1>

<!-- ğŸ® ì‹œì‘ í™”ë©´ -->
<div id="start-screen" class="screen active">
  <p>ê°•ì•„ì§€ ì´ë¦„ì„ ì§€ì–´ì£¼ì„¸ìš”:</p>
  <input type="text" id="puppy-name" placeholder="ì˜ˆ: ë­‰ì¹˜" />
  <p>ê°•ì•„ì§€ í’ˆì¢…ì„ ì„ íƒí•˜ì„¸ìš”:</p>
  <div>
    <button class="button" onclick="selectBreed('g')">ê³¨ë“  ë¦¬íŠ¸ë¦¬ë²„</button>
    <button class="button" onclick="selectBreed('b')">ë¹„ìˆ‘ í”„ë¦¬ì œ</button>
  </div>
  <button class="button" onclick="startGame()">ê²Œì„ ì‹œì‘</button>
</div>

<!-- ğŸ¾ ê²Œì„ í™”ë©´ -->
<div id="game-screen" class="screen">
  <div id="game-wrapper">
    <img id="puppy-img" class="puppy-image" src="" alt="ê·€ì—¬ìš´ ê°•ì•„ì§€" />
    <div class="status-bar" id="statusBar"></div>
    <div class="event-timer" id="eventTimer">ë‹¤ìŒ ì´ë²¤íŠ¸ê¹Œì§€: 20ì´ˆ</div>
    <div class="celebrate" id="celebrate">ğŸ‰ ì„±ì¥í–ˆì–´ìš”!</div>
  </div>
  <div class="interaction-toggle">
    <button class="button" onclick="toggleInteractionPanel()">ì§ì ‘ ìƒí˜¸ì‘ìš© ğŸ”</button>
  </div>
  <div class="interaction-panel" id="interactionPanel">
    <button class="button" onclick="directInteraction('ì“°ë‹¤ë“¬ê¸°')">ì“°ë‹¤ë“¬ê¸°</button>
    <button class="button" onclick="directInteraction('ê·€ ëƒ„ìƒˆ ë§¡ê¸°')">ê·€ ëƒ„ìƒˆ ë§¡ê¸°</button>
    <button class="button" onclick="directInteraction('ë°œ ëƒ„ìƒˆ ë§¡ê¸°')">ë°œ ëƒ„ìƒˆ ë§¡ê¸°</button>
    <button class="button" onclick="directInteraction('ê»´ì•ˆê¸°')">ê»´ì•ˆê¸°</button>
  </div>
  <audio id="bgm" loop autoplay>
    <source src="https://dessa95.github.io/puppy-game-drive/bgm.mp3" type="audio/mp3" />
  </audio>
</div>
<script>
let puppyName = "";
let breed = "";
let age = 0;
let hunger = 50;
let intimacy = 50;
let ageInterval, eventInterval, countdownInterval;
let eventRemaining = 5;
let eventRunning = false;

const puppyImg = document.getElementById("puppy-img");
const statusBar = document.getElementById("statusBar");
const eventTimer = document.getElementById("eventTimer");
const celebrate = document.getElementById("celebrate");

function selectBreed(selected) {
  breed = selected;
}

function startGame() {
  puppyName = document.getElementById("puppy-name").value || "ê°•ì•„ì§€";
  if (!breed) { alert("ê°•ì•„ì§€ í’ˆì¢…ì„ ì„ íƒí•˜ì„¸ìš”!"); return; }

  document.getElementById("start-screen").classList.remove("active");
  document.getElementById("game-screen").classList.add("active");

  updateStatus();
  updatePuppyImage();
  startTimers();
}

function getGrowthStage() {
  if (age < 2) return "ì‹ ìƒì•„ê¸°";
  if (age < 6) return "ì²­ì†Œë…„ê¸°";
  if (age < 10) return "ì„±ë…„ê¸°";
  return "ë…¸ë ¹ê¸°";
}

function updatePuppyImage() {
  const stageIndex = age < 2 ? 1 : age < 6 ? 2 : age < 10 ? 3 : 4;
  const imageCode = breed + stageIndex;
  puppyImg.src = `https://dessa95.github.io/puppy-game-drive/${imageCode}.png`;
}

function updateStatus() {
  const stage = getGrowthStage();
  statusBar.innerHTML =
    `ğŸ¾ ì´ë¦„: ${puppyName}<br>ğŸ“… ë‚˜ì´: ${age}ì‚´ (${stage})<br>ğŸ– ë°°ê³ í””: ${hunger}<br>â¤ï¸ ì¹œë°€ë„: ${intimacy}`;
}

function checkGrowth() {
  const stage = getGrowthStage();
  if (age === 2 || age === 6 || age === 10) {
    celebrate.innerText = `ğŸ‰ ${stage}ë¡œ ì„±ì¥í–ˆì–´ìš”!`;
    celebrate.style.display = "block";
    puppyImg.classList.add("grow");
    updatePuppyImage();
    setTimeout(() => {
      celebrate.style.display = "none";
      puppyImg.classList.remove("grow");
    }, 2000);
  } else {
    updatePuppyImage();
  }
}

function startTimers() {
  ageInterval = setInterval(() => {
    if (!eventRunning) {
      age++;
      checkGrowth();
      updateStatus();
    }
  }, 20000); // 20ì´ˆë§ˆë‹¤ í•œ ì‚´

  eventInterval = setInterval(() => {
    if (!eventRunning) triggerRandomEvent();
  }, 5000); // 5ì´ˆë§ˆë‹¤ ì´ë²¤íŠ¸

  countdownInterval = setInterval(() => {
    if (!eventRunning) {
      eventRemaining--;
      if (eventRemaining < 0) eventRemaining = 5;
      eventTimer.innerText = `ë‹¤ìŒ ì´ë²¤íŠ¸ê¹Œì§€: ${eventRemaining}ì´ˆ`;
    }
  }, 1000);
}

function toggleInteractionPanel() {
  const panel = document.getElementById("interactionPanel");
  panel.style.display = (panel.style.display === "flex") ? "none" : "flex";
}

function directInteraction(type) {
  let msg = "";
  switch (type) {
    case "ì“°ë‹¤ë“¬ê¸°":
      intimacy += 8;
      msg = "â¤ï¸ ì“°ë‹¤ë“¬ì–´ì¤¬ì–´ìš”! ê¸°ë¶„ ì¢‹ì•„ìš”!";
      break;
    case "ê·€ ëƒ„ìƒˆ ë§¡ê¸°":
      intimacy += 3;
      msg = "ğŸ‘ƒ ê·€ì—ì„œ ê³ ì†Œí•œ í–¥ì´ ë‚˜ìš”!";
      break;
    case "ë°œ ëƒ„ìƒˆ ë§¡ê¸°":
      intimacy += 2;
      msg = "ğŸ¦¶ ìŒ... ì´ ëƒ„ìƒˆëŠ”!";
      break;
    case "ê»´ì•ˆê¸°":
      intimacy += 10;
      msg = "ğŸ¤— ê»´ì•ˆì•„ì¤¬ì–´ìš”! ì‚¬ë‘ì´ ë„˜ì³ìš”!";
      break;
  }

  showEffect(msg);
  puppyImg.classList.add("shake");
  setTimeout(() => puppyImg.classList.remove("shake"), 1000);
  updateStatus();
}
const events = [
  { text: "ì‚°ì±… ê°ˆ ì‹œê°„ì´ì—ìš”!", choices: [
      { text: "ì‹ ë‚˜ê²Œ ë‹¬ë¦°ë‹¤", stat: 'intimacy', value: 10 },
      { text: "ì²œì²œíˆ ê±·ëŠ”ë‹¤", stat: 'intimacy', value: 5 }
    ]
  },
  { text: "ëª©ìš•í•  ì‹œê°„! ë¬¼ì´ ì‹«ì–´ìš”!", choices: [
      { text: "ë¶€ë“œëŸ½ê²Œ ì”»ê¸´ë‹¤", stat: 'intimacy', value: 5 },
      { text: "ê°„ì‹ì„ ì£¼ë©° ë‹¬ëœë‹¤", stat: 'hunger', value: 10, stat2: 'intimacy', value2: 2 }
    ]
  },
  { text: "ë°°ê°€ ê³ íŒŒìš”! ë°¥ ì£¼ì„¸ìš”!", choices: [
      { text: "ì‚¬ë£Œë¥¼ ì¤€ë‹¤", stat: 'hunger', value: 20 },
      { text: "íŠ¹ì‹ì„ ì¤€ë‹¤", stat: 'hunger', value: 30, stat2: 'intimacy', value2: 5 }
    ]
  },
  { text: "ë†€ì•„ì£¼ì„¸ìš”!", choices: [
      { text: "ê³µë†€ì´ë¥¼ í•œë‹¤", stat: 'intimacy', value: 15 },
      { text: "í„°ê·¸ ë†€ì´ë¥¼ í•œë‹¤", stat: 'intimacy', value: 12 }
    ]
  },
  { text: "ë³‘ì› ê°€ëŠ” ë‚ ì´ì—ìš”!", choices: [
      { text: "ìš©ê°í•˜ê²Œ ì£¼ì‚¬ ë§ê¸°", stat: 'intimacy', value: -5 },
      { text: "ì¹­ì°¬í•˜ë©° ë‹¬ë˜ì£¼ê¸°", stat: 'intimacy', value: 5 }
    ]
  },
  { text: "ìƒˆë¡œìš´ ê°œì¸ê¸°ë¥¼ ë°°ìš¸ë˜ìš”!", choices: [
      { text: "'ì†!' ê°€ë¥´ì¹˜ê¸°", stat: 'intimacy', value: 10 },
      { text: "'ì½”!' ê°€ë¥´ì¹˜ê¸°", stat: 'intimacy', value: 10 }
    ]
  },
  { text: "ì‹¤ìˆ˜í–ˆì–´ìš”... ì§‘ì´ ì—‰ë§ì´ ëì–´ìš”.", choices: [
      { text: "ê´œì°®ì•„, ê°™ì´ ì¹˜ìš°ì", stat: 'intimacy', value: 7 },
      { text: "ì¡°ìš©íˆ í˜¼ë‚¸ë‹¤", stat: 'intimacy', value: -10 }
    ]
  },
  { text: "ê³µì›ì—ì„œ ì¹œêµ¬ë¥¼ ë§Œë‚¬ì–´ìš”!", choices: [
      { text: "ê°™ì´ ë†€ê²Œ í•œë‹¤", stat: 'intimacy', value: 10 },
      { text: "ì¡°ì‹¬í•˜ë¼ê³  ë¶€ë¥¸ë‹¤", stat: 'intimacy', value: -2 }
    ]
  },
  { text: "ìˆ¨ê²¨ë‘” ê°„ì‹ì„ ì°¾ì•˜ì–´ìš”!", choices: [
      { text: "ë§›ìˆê²Œ ë¨¹ì–´", stat: 'hunger', value: 15, stat2: 'intimacy', value2: 5 },
      { text: "ì´ë”° ë°¥ ë¨¹ì–´ì•¼ì§€", stat: 'hunger', value: -5 }
    ]
  },
  { text: "ì˜¤ëŠ˜ì€ í›ˆë ¨ ë‚ ! ì§‘ì¤‘í•´ìš”!", choices: [
      { text: "ì§‘ì¤‘í•´ì„œ í›ˆë ¨ì‹œí‚¨ë‹¤", stat: 'intimacy', value: 8 },
      { text: "ê°„ì‹ìœ¼ë¡œ ìœ ë„í•œë‹¤", stat: 'hunger', value: -10, stat2: 'intimacy', value2: 6 }
    ]
  },
  { text: "ê°•ì•„ì§€ê°€ ìš°ìš¸í•´ ë³´ì—¬ìš”.", choices: [
      { text: "ì•ˆì•„ì¤€ë‹¤", stat: 'intimacy', value: 10 },
      { text: "ë†€ì•„ì¤€ë‹¤", stat: 'intimacy', value: 7 }
    ]
  },
  { text: "ì¥ë‚œê°ì„ ë¬¼ì–´ì™”ì–´ìš”!", choices: [
      { text: "ê°™ì´ ë†€ì•„ì¤€ë‹¤", stat: 'intimacy', value: 9 },
      { text: "ë‚˜ì¤‘ì— ë†€ìê³  í•œë‹¤", stat: 'intimacy', value: -3 }
    ]
  },
  { text: "ê°‘ìê¸° ì§–ì–´ìš”!", choices: [
      { text: "ë¬´ìŠ¨ ì¼ì´ì•¼? í™•ì¸í•œë‹¤", stat: 'intimacy', value: 5 },
      { text: "ì¡°ìš©íˆ ì‹œí‚¨ë‹¤", stat: 'intimacy', value: -2 }
    ]
  },
  { text: "ë¹—ì† ì‚°ì±…ì„ ë‚˜ê°€ì•¼ í•´ìš”!", choices: [
      { text: "ìš°ë¹„ ì…íˆê³  ë‚˜ê°„ë‹¤", stat: 'intimacy', value: 5 },
      { text: "ì˜¤ëŠ˜ì€ ì‰°ë‹¤", stat: 'intimacy', value: -3 }
    ]
  }
];

function triggerRandomEvent() {
  eventRunning = true;
  const wrapper = document.getElementById("game-wrapper");
  const event = events[Math.floor(Math.random() * events.length)];

  const popup = document.createElement("div");
  popup.style.position = "absolute";
  popup.style.top = "10%";
  popup.style.left = "50%";
  popup.style.transform = "translateX(-50%)";
  popup.style.background = "#fff7f0";
  popup.style.padding = "20px";
  popup.style.border = "2px solid #ffa478";
  popup.style.borderRadius = "15px";
  popup.style.zIndex = "1000";
  popup.style.textAlign = "center";
  popup.style.boxShadow = "0 5px 15px rgba(0,0,0,0.15)";
  popup.innerHTML = `<p style="font-size: 1.1rem; margin-bottom: 10px;">${event.text}</p>`;

  event.choices.forEach((choice) => {
    const btn = document.createElement("button");
    btn.className = "button";
    btn.innerText = choice.text;
    btn.onclick = () => {
      if (choice.stat) window[choice.stat] += choice.value;
      if (choice.stat2) window[choice.stat2] += choice.value2 || 0;

      if (choice.value > 0 || (choice.stat2 && choice.value2 > 0)) {
        puppyImg.classList.add("shake");
        setTimeout(() => puppyImg.classList.remove("shake"), 600);
        showEffect("ğŸ¾ ê¸°ë¶„ì´ ì¢‹ì•„ì¡Œì–´ìš”!");
      }

      updateStatus();
      wrapper.removeChild(popup);
      eventRunning = false;
    };
    popup.appendChild(btn);
  });

  wrapper.appendChild(popup);
}

function showEffect(text) {
  const eff = document.createElement("div");
  eff.innerText = text;
  eff.style.position = "absolute";
  eff.style.top = "50%";
  eff.style.left = "50%";
  eff.style.transform = "translate(-50%, -50%)";
  eff.style.background = "#fff8c6";
  eff.style.color = "#e04e00";
  eff.style.padding = "10px 20px";
  eff.style.border = "1px solid #f0b76c";
  eff.style.borderRadius = "12px";
  eff.style.zIndex = "999";
  eff.style.fontSize = "1rem";
  eff.style.boxShadow = "0 2px 5px rgba(0,0,0,0.2)";
  document.body.appendChild(eff);
  setTimeout(() => eff.remove(), 1800);
}
</script>

<style>
@keyframes shake {
  0% { transform: translateX(0); }
  25% { transform: translateX(-10px); }
  50% { transform: translateX(10px); }
  75% { transform: translateX(-10px); }
  100% { transform: translateX(0); }
}
@keyframes grow {
  0% { transform: scale(1); }
  50% { transform: scale(1.3); }
  100% { transform: scale(1); }
}
#puppy-img.shake { animation: shake 0.6s ease; }
#puppy-img.grow { animation: grow 0.6s ease; }
</style>

<script>
window.addEventListener("load", () => {
  const bgm = document.getElementById("bgm");
  if (bgm) {
    bgm.volume = 0.5;
    bgm.play().catch(() => {
      document.body.addEventListener("click", () => bgm.play(), { once: true });
    });
  }
});
</script>
</body>
</html>
